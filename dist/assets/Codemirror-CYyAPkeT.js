import{m as _,B as E,T as H,R as B,P as m,W as F,C as T,n as D}from"./index-BPuQh0ys.js";import{E as g,H as L,s as P,t as e,a as Z,b as A,i as O,k as $,c as I,S as N,j as W,d as q}from"./codemirror-ZSHHXwGs.js";import"./vuetify-Ce4WN_Dg.js";import"./overlayscrollbars-CiKU261J.js";import"./echarts-DzoUeqWp.js";function h(){return h=Object.assign?Object.assign.bind():function(o){for(var i=1;i<arguments.length;i++){var r=arguments[i];for(var n in r)({}).hasOwnProperty.call(r,n)&&(o[n]=r[n])}return o},h.apply(null,arguments)}var w=o=>{var{theme:i,settings:r={},styles:n=[]}=o,t={".cm-gutters":{}},a={};r.background&&(a.backgroundColor=r.background),r.backgroundImage&&(a.backgroundImage=r.backgroundImage),r.foreground&&(a.color=r.foreground),r.fontSize&&(a.fontSize=r.fontSize),(r.background||r.foreground)&&(t["&"]=a),r.fontFamily&&(t["&.cm-editor .cm-scroller"]={fontFamily:r.fontFamily}),r.gutterBackground&&(t[".cm-gutters"].backgroundColor=r.gutterBackground),r.gutterForeground&&(t[".cm-gutters"].color=r.gutterForeground),r.gutterBorder&&(t[".cm-gutters"].borderRightColor=r.gutterBorder),r.caret&&(t[".cm-content"]={caretColor:r.caret},t[".cm-cursor, .cm-dropCursor"]={borderLeftColor:r.caret});var l={};r.gutterActiveForeground&&(l.color=r.gutterActiveForeground),r.lineHighlight&&(t[".cm-activeLine"]={backgroundColor:r.lineHighlight},l.backgroundColor=r.lineHighlight),t[".cm-activeLineGutter"]=l,r.selection&&(t["&.cm-focused .cm-selectionBackground, & .cm-line::selection, & .cm-selectionLayer .cm-selectionBackground, .cm-content ::selection"]={background:r.selection+" !important"}),r.selectionMatch&&(t["& .cm-selectionMatch"]={backgroundColor:r.selectionMatch});var f=g.theme(t,{dark:i==="dark"}),p=L.define(n),k=[f,P(p)];return k},K={background:"#ffffff",foreground:"#383a42",caret:"#000",selection:"#add6ff",selectionMatch:"#a8ac94",lineHighlight:"#99999926",gutterBackground:"#fff",gutterForeground:"#237893",gutterActiveForeground:"#0b216f",fontFamily:'Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace'},R=[{tag:[e.keyword,e.operatorKeyword,e.modifier,e.color,e.constant(e.name),e.standard(e.name),e.standard(e.tagName),e.special(e.brace),e.atom,e.bool,e.special(e.variableName)],color:"#0000ff"},{tag:[e.moduleKeyword,e.controlKeyword],color:"#af00db"},{tag:[e.name,e.deleted,e.character,e.macroName,e.propertyName,e.variableName,e.labelName,e.definition(e.name)],color:"#0070c1"},{tag:e.heading,fontWeight:"bold",color:"#0070c1"},{tag:[e.typeName,e.className,e.tagName,e.number,e.changed,e.annotation,e.self,e.namespace],color:"#267f99"},{tag:[e.function(e.variableName),e.function(e.propertyName)],color:"#795e26"},{tag:[e.number],color:"#098658"},{tag:[e.operator,e.punctuation,e.separator,e.url,e.escape,e.regexp],color:"#383a42"},{tag:[e.regexp],color:"#af00db"},{tag:[e.special(e.string),e.processingInstruction,e.string,e.inserted],color:"#a31515"},{tag:[e.angleBracket],color:"#383a42"},{tag:e.strong,fontWeight:"bold"},{tag:e.emphasis,fontStyle:"italic"},{tag:e.strikethrough,textDecoration:"line-through"},{tag:[e.meta,e.comment],color:"#008000"},{tag:e.link,color:"#4078f2",textDecoration:"underline"},{tag:e.invalid,color:"#e45649"}];function V(o){var{theme:i="light",settings:r={},styles:n=[]}={};return w({theme:i,settings:h({},K,r),styles:[...R,...n]})}var z=V(),U={background:"#1e1e1e",foreground:"#9cdcfe",caret:"#c6c6c6",selection:"#6199ff2f",selectionMatch:"#72a1ff59",lineHighlight:"#ffffff0f",gutterBackground:"#1e1e1e",gutterForeground:"#838383",gutterActiveForeground:"#fff",fontFamily:'Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace'},G=[{tag:[e.keyword,e.operatorKeyword,e.modifier,e.color,e.constant(e.name),e.standard(e.name),e.standard(e.tagName),e.special(e.brace),e.atom,e.bool,e.special(e.variableName)],color:"#569cd6"},{tag:[e.controlKeyword,e.moduleKeyword],color:"#c586c0"},{tag:[e.name,e.deleted,e.character,e.macroName,e.propertyName,e.variableName,e.labelName,e.definition(e.name)],color:"#9cdcfe"},{tag:e.heading,fontWeight:"bold",color:"#9cdcfe"},{tag:[e.typeName,e.className,e.tagName,e.number,e.changed,e.annotation,e.self,e.namespace],color:"#4ec9b0"},{tag:[e.function(e.variableName),e.function(e.propertyName)],color:"#dcdcaa"},{tag:[e.number],color:"#b5cea8"},{tag:[e.operator,e.punctuation,e.separator,e.url,e.escape,e.regexp],color:"#d4d4d4"},{tag:[e.regexp],color:"#d16969"},{tag:[e.special(e.string),e.processingInstruction,e.string,e.inserted],color:"#ce9178"},{tag:[e.angleBracket],color:"#808080"},{tag:e.strong,fontWeight:"bold"},{tag:e.emphasis,fontStyle:"italic"},{tag:e.strikethrough,textDecoration:"line-through"},{tag:[e.meta,e.comment],color:"#6a9955"},{tag:e.link,color:"#6a9955",textDecoration:"underline"},{tag:e.invalid,color:"#ff0000"}];function X(o){var{theme:i="dark",settings:r={},styles:n=[]}={};return w({theme:i,settings:h({},U,r),styles:[...G,...n]})}var Y=X();const b={token:function(o,i,r=0){const n=o.peek();if(o.pos===r&&i.klipperMacro&&(i.klipperMacro=!1),o.pos>r&&i.klipperMacro){if(o.eatSpace(),o.match(/^{/))return"tag";if(o.match(/^"[^{]+"/)||o.match(/^'[^{]+'/))return"string";if(o.match(/^[-+]?[0-9]*\.?[0-9]+/))return"number";if(o.match(/^[A-Za-z\d_]+/))return"propertyName";if(r===0&&o.match(/^{[^%]+}/))return"variable"}if([";"].includes(n!=null?n:""))return o.skipToEnd(),"comment";const t=o.pos==r;return t&&o.match(/_?[GMgm][\d.]+/)?"namespace":o.string.substring(r).toLowerCase().startsWith("m117")?(o.skipToEnd(),"string"):o.pos>r&&o.match(/[EPXYZIJ]-?([\d]*\.[\d]+|[\d]+)?/i)?"className":o.pos>r&&o.match(/[Ff]-?([\d]*\.[\d]+|[\d]+)?/)?"string":o.pos>r&&o.match(/[TtSs]-?([\d]*\.[\d]+|[\d]+)?/)?"atom":r===0&&o.pos>r&&o.match(/^{[^%]+}/)?"propertyName":t&&o.match(/^\s*[A-Z_\d]+/)?(i.klipperMacro=!0,"name"):(o.next(),null)},startState:function(){return{klipperMacro:!1}},languageData:{commentTokens:{line:";"}}},Q={token:function(o,i){var y,x;const r=["\\+","-","\\/\\/","\\/","%","\\*\\*","\\*","\\(","\\)","==","!=",">=",">","<=","<","=","\\|","~",","],n=new RegExp("^"+r.join("|")),t=["elif","else","endif","if","endfor","for","loop\\.index","loop\\.revindex","loop\\.first","loop\\.last","loop\\.length","loop\\.cycle","loop\\.depth","and","or","not","in","is","endmacro","macro","endcall","call","endfilter","filter","endset","set","extends","block","endblock","include","import","do"],a=["abs","attr","batch","capitalize","center","default","dictsort","escape","filesizeformat","first","float","forceescape","format","groupby","indent","int","join","last","length","list","lower","map","max","min","pprint","random","reject","rejectattr","replace","reverse","round","tojson","safe","select","selectattr","slice","sort","string","striptags","sum","title","trim","truncate","unique","upper","urlencode","urlize","wordcount","wordwrap","xmlattr"],l=["callable","defined","divisibleby","equalto","escaped","even","iterable","lower","mapping","none","number","odd","sameas","sequence","string","undefined","upper"],f=["range","lipsum","dict","cycler","joiner"],p=["\\.reset\\(\\)","\\.next\\(\\)"],k=new RegExp("^"+t.join("\\s+|")+"|"+p.join("|")+"\\s+"),C=new RegExp("^"+a.join("|")+"|"+l.join("|")+"|"+f.join("|")+"\\s+");function v(c){var S;const M=c.match(/^%}/),J=c.match(/^}/);function j(){return i.klipperMacroJinjaBraceStack.length===0&&i.klipperMacroJinjaPctStack.length===0}return M||J?(M?(i.klipperMacroJinjaPctStack.pop(),j()&&(i.klipperMacroJinja=!1)):(i.klipperMacroJinjaBraceStack.pop(),j()&&(i.klipperMacroJinja=!1)),c.eatSpace(),i.gcodeZeroPos=c.pos,"tag"):c.match(new RegExp("^((?<![\\\\])['\"])((?:.(?!(?<![\\\\])\\1))*.?)\\1"))?(i.klipperMacroJinjaHighlightNext=!0,"string"):c.eol()&&c.match(/^"/)?(i.klipperMacroJinjaHighlightNext=!1,"string"):i.klipperMacroJinjaHighlightNext&&c.match(k)?(i.klipperMacroJinjaHighlightNext=!1,"keyword"):i.klipperMacroJinjaHighlightNext&&c.match(C)&&["(","}",",","|"," "].includes((S=c.peek())!=null?S:"")?(i.klipperMacroJinjaHighlightNext=!1,"updateOperator"):c.match(n)?(i.klipperMacroJinjaHighlightNext=!0,"number"):c.match(/^true\s|false\s/i)?(i.klipperMacroJinjaHighlightNext=!1,"atom"):c.match(/^[-+]?[0-9]*\.?[0-9]+/)?(i.klipperMacroJinjaHighlightNext=!1,"number"):c.eatSpace()?(i.klipperMacroJinjaHighlightNext=!0,"propertyName"):(c.next(),i.klipperMacroJinjaHighlightNext=!1,"propertyName")}const s=o.peek();if(o.match(/^\s+[#;]/)||[";","#"].includes(s!=null?s:"")&&(o.pos===0||/\s/.test(o.string.charAt(o.pos-1))))return o.skipToEnd(),i.block=!1,i.pair=!1,"comment";if(s!=="["&&o.indentation()===0&&o.sol()&&o.match(/^[^:]+$/i))return o.skipToEnd(),null;if(o.indentation()===0){if(o.pos===0&&s==="[")return i.block=!0,o.next(),null;if(i.block){if(!s||s==="]"||o.eol())return o.next(),i.block=!1,null;if(o.match(/^\s[^\]]+/))return"className";if(o.match(/^[^ \]]+/))return"namespace"}if(i.gcode)return o.sol()||o.eol()?(i.gcode=!1,i.gcodeZeroPos=null,null):(i.gcodeZeroPos||(o.eatSpace(),i.gcodeZeroPos=o.pos),o.match(/^\s*{[%#]?/)?(i.klipperMacroJinja=!0,o.string.includes("{%")?i.klipperMacroJinjaPctStack.push("{%"):i.klipperMacroJinjaBraceStack.push("{"),"tag"):i.klipperMacroJinja?v(o):b.token(o,i,(y=i.gcodeZeroPos)!=null?y:0))}else{if(i.was=!0,i.gcode)return o.sol()&&(o.eatSpace(),i.gcodeZeroPos=o.pos),o.match(/^\s*{[%#]?/)?(i.klipperMacroJinja=!0,o.string.includes("{%")?i.klipperMacroJinjaPctStack.push("{%"):i.klipperMacroJinjaBraceStack.push("{"),"tag"):i.klipperMacroJinja?v(o):b.token(o,i,(x=i.gcodeZeroPos)!=null?x:o.pos);if(i.pair){if(o.eatSpace(),s!==","){if(o.match(/^-?\d*\.?(?:\d+)?($|,)/))return"number";if(o.match(/^[^#]+/))return"string"}return o.next(),null}}if(i.was&&o.indentation()===0&&(i.pair=!1,i.gcode=!1,i.was=!1),!i.pair&&!i.gcode&&o.sol())return o.match(/^(?:[A-Za-z]*_?gcode|enable):/)?i.gcode=!0:(o.match(/^.+?:\s*/),i.pair=!o.eol()),"atom";if(i.pair){if(s===":")return o.next(),o.eatSpace(),null;if(!s||o.eol())return i.pair=!1,null;if(o.match(/^(-?\d*\.?(?:\d+)?(,|$|\s))+/))return i.pair=!1,"number";if(o.match(/^[^#]+/))return i.pair=!1,"string"}return o.next(),null},startState:function(){return{block:!1,pair:!1,was:!1,gcode:!1,klipperMacro:!1,gcodeZeroPos:null,klipperMacroJinja:!1,klipperMacroJinjaHighlightNext:!1,klipperMacroJinjaBraceStack:[],klipperMacroJinjaPctStack:[]}},languageData:{commentTokens:{line:"#"}}};var ee=Object.defineProperty,ie=Object.getOwnPropertyDescriptor,d=(o,i,r,n)=>{for(var t=n>1?void 0:n?ie(i,r):i,a=o.length-1,l;a>=0;a--)(l=o[a])&&(t=(n?l(i,r,t):l(t))||t);return n&&t&&ee(i,r,t),t};let u=class extends _(E,H){constructor(){super(...arguments),this.content="",this.codemirror=null,this.cminstance=null}valueChanged(i){var n,t;const r=(t=(n=this.cminstance)==null?void 0:n.state)==null?void 0:t.doc.toString();i!==r&&this.setCmValue(i)}mounted(){this.initialize()}beforeDestroy(){this.destroy()}destroy(){var i;(i=this.cminstance)==null||i.destroy()}initialize(){this.codemirror=new g({parent:this.editor}),this.cminstance=this.codemirror,this.$nextTick(()=>{this.setCmValue(this.code||this.value||this.content),this.$emit("ready",this.codemirror)})}setCmValue(i){var r;(r=this.cminstance)==null||r.setState(Z.create({doc:i,extensions:this.cmExtensions}))}get cmExtensions(){const i=[g.theme({},{dark:this.themeMode==="dark"}),A,this.vscodeTheme,O.of(" ".repeat(this.tabSize)),$.of([I]),g.updateListener.of(r=>{var n,t,a,l,f;if(r.selectionSet){const p=(l=(n=this.cminstance)==null?void 0:n.state)==null?void 0:l.doc.lineAt((a=(t=this.cminstance)==null?void 0:t.state)==null?void 0:a.selection.main.head).number;this.$emit("lineChange",p)}this.content=(f=r.state)==null?void 0:f.doc.toString(),this.$emit&&this.$emit("input",this.content)})];return["cfg","conf"].includes(this.fileExtension)?i.push(N.define(Q)):["gcode"].includes(this.fileExtension)?i.push(N.define(b)):["json"].includes(this.fileExtension)?i.push(W()):["css","scss","sass"].includes(this.fileExtension)&&i.push(q()),i}visibilityChanged(i){var r;i&&((r=this.cminstance)==null||r.focus())}get tabSize(){return this.$store.state.gui.editor.tabSize||2}get vscodeTheme(){return this.themeMode==="dark"?Y:z}gotoLine(i){var n,t,a;const r=(t=(n=this.cminstance)==null?void 0:n.state)==null?void 0:t.doc.line(i);r&&((a=this.cminstance)==null||a.dispatch({selection:{head:r.from,anchor:r.to},scrollIntoView:!0}))}};d([B("editor")],u.prototype,"editor",2);d([m({required:!1,default:""})],u.prototype,"code",2);d([m({required:!1,default:""})],u.prototype,"value",2);d([m({required:!1,default:"codemirror"})],u.prototype,"name",2);d([m({required:!1,default:""})],u.prototype,"fileExtension",2);d([F("value")],u.prototype,"valueChanged",1);u=d([T],u);var oe=function(){var i=this,r=i._self._c;return i._self._setupProxy,r("div",{staticClass:"vue-codemirror"},[r("div",{directives:[{name:"observe-visibility",rawName:"v-observe-visibility",value:i.visibilityChanged,expression:"visibilityChanged"}],ref:"editor"})])},re=[],te=D(u,oe,re,!1,null,null);const de=te.exports;export{de as default};
